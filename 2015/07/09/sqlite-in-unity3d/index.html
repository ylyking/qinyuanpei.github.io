<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Unity3D游戏开发之SQLite让数据库开发更简单 | 秦元培</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="做单纯的人，走幸福的路。">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Unity3D游戏开发之SQLite让数据库开发更简单 | 秦元培">
    <meta name="twitter:description" content="做单纯的人，走幸福的路。">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Unity3D游戏开发之SQLite让数据库开发更简单 | 秦元培">
    <meta property="og:description" content="做单纯的人，走幸福的路。">

    
    <meta name="author" content="秦元培">
    
    <link rel="stylesheet" href="/css/vno.css" type="text/css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" type="text/css">

    
    <link rel="icon" href="/images/favicon.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="秦元培" href="/atom.xml">
    

    <link rel="canonical" href="http://qinyuanpei.com/2015/07/09/sqlite-in-unity3d/"/>

    
</head>

<body class="home-template no-js">

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="秦元培"><img src="/images/logo.jpg"  width="100" alt="秦元培 logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="秦元培">秦元培</a></h1>
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">目标就是给梦想一个期限</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
            
              <li class="navigation__item"><a href="/archives">文章归档</a></li>
            
              <li class="navigation__item"><a href="/links">友情链接</a></li>
            
              <li class="navigation__item"><a href="/about">关于我</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="http://weibo.com/u/1278609231" title="新浪微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li> 


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/qinyuanpei" title="GitHub主页" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>



  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  <li class="navigation__item">
    <a href="mailto:qinyuanpei@163.com" title="发送邮件" target="_blank">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>


  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-blue"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2015-07-09T01:47:06.000Z" class="post-list__meta--date date">2015-07-09</time> &#8226; <span class="post-meta__tags tags">由<a href="http://qinyuanpei.com">秦元培</a>发布于&nbsp;
  <a class="tag-link" href="/tags/SQLite/">SQLite</a>, <a class="tag-link" href="/tags/Unity3D/">Unity3D</a>, <a class="tag-link" href="/tags/数据库/">数据库</a>
阅读(<span id="busuanzi_value_page_pv"></span>)</span>
    </div>
    <h1 class="post-title">Unity3D游戏开发之SQLite让数据库开发更简单</h1>
  </header>

  <section class="post">
    <p>各位朋友大家好，欢迎大家关注我的博客，我是秦元培，我是博客地址是<a href="http://blog.csdn.net/qinyuanpei" target="_blank" rel="external">http://blog.csdn.net/qinyuanpei</a>。在经历了一段时间的忙碌后，博主终于有时间来研究新的东西啦，今天博客向和大家一起交流的内容是在Unity3D游戏开发中使用SQLite进行数据库开发，坦白来讲，在我的技术体系中Web和数据库是相对薄弱的两个部分，因此正好这段时间项目需要和服务器、数据库进行交互，因此在接下来的文章中博主可能会更加倾向于讲解这方面的内容，希望大家能够喜欢啊！</p>
<h2 id="一、什么是SQLite？">一、什么是SQLite？</h2><p><a href="http://www.sqlite.org/" target="_blank" rel="external">SQLite</a>是一款轻型的数据库，是遵守ACID的关系型数据库管理系统，它包含在一个相对小的C库中，以嵌入式作为它的设计目标，它占用资源非常的低，因此适合在嵌入式设备如Android、Ruby on Rails等中使用。它能够支持Windows/Linux/Unix等等主流的操作系统，同时能够跟和C、C++、Ruby、Python、C#、PHP、Java等编程语言相结合。SQLite是一个以文件形式存在的关系型数据库，尽管无法实现分布式和横向扩展，可是作为一个轻量级的嵌入式数据库，它不需要系统提供服务支持，通过SDK直接操作文件避免了对数据库维护的相关事务，从这个角度来讲它是一个出色的数据库。</p>
<h2 id="二、为什么要选择SQLite">二、为什么要选择SQLite</h2><p>好了，在了解了SQLite后，我们来了解下SQLite有哪些让我们心动的特性，或者说我们为什么要选择SQLite，因为在这个世界上我们有太多的数据库可以选择，诸如Oracle、MySQL、SQLServer、DB2、NoSQL、MongoDB等等：</p>
<blockquote>
<ul>
<li>ACID事务</li>
<li>零配置 – 无需安装和管理配置</li>
<li>储存在单一磁盘文件中的一个完整的数据库</li>
<li>数据库文件可以在不同字节顺序的机器间自由的共享</li>
<li>支持数据库大小至2TB</li>
<li>足够小, 大致13万行C代码, 4.43M</li>
<li>比一些流行的数据库在大部分普通数据库操作要快—-<a href="http://www.zhihu.com/question/31417262" target="_blank" rel="external">SQLite读写效率如此之高，会使用其他数据库的理由是？</a></li>
<li>简单, 轻松的API</li>
<li>包含TCL绑定, 同时通过Wrapper支持其他语言的绑定</li>
<li>良好注释的源代码, 并且有着90%以上的测试覆盖率</li>
<li>独立: 没有额外依赖</li>
<li>源码完全的开源, 你可以用于任何用途, 包括出售它</li>
<li>支持多种开发语言，C, C++, PHP, Perl, Java, C#,Python, Ruby等</li>
</ul>
</blockquote>
<h2 id="三、Unity3D中的SQLite">三、Unity3D中的SQLite</h2><p>在Unity3D中使用SQLite，我们首先要明白这样一件事情，即我们这里的使用的SQLite并非是通常意义上的SQLite.NET,而是经过移植后的Mono.Data.Sqlite。因为Unity3D基于Mono，因此使用移植后的Mono.Data.Sqlite能够减少我们的项目在不同平台上出现各种各样的问题。在Unity3D中使用的SQLite以Mono.Data.Sqlite.dll即动态链接库的形式给出，因此我们需要将这个文件放置在项目目录下的Plugins文件夹中，此外我们需要System.Data.dll或者Mono.Data.dll这两个文件添加到Plugins目录中，因为我们需要的部分数据相关的API或者类都定义在这两个文件当中，这些文件可以从<a href="http://pan.baidu.com/s/1sjLZyrj" target="_blank" rel="external">这里</a>直接下载。</p>
<blockquote>
<p>PS：博主注意到在网上有使用Mono.Data.SQLiteClient.dll这个库实现在Unity3D操作SQLite数据库的相关文章，博主大概看了下，感觉和使用Mono.Data.Sqlite.dll这个库大同小异，大家喜欢哪个就用哪个吧！哈哈！博主在开源社区找到一个版本库，据说可以同时支持.NET和Mono，如果大家感兴趣欢迎大家去测试啊，哈哈!</p>
</blockquote>
<p>在正式开始写代码前，我们首先来回顾下通常情况下数据库读写的基本流程吧！</p>
<blockquote>
<ul>
<li>定义数据库连接字符串(ConnectionString)完成数据库连接的构造，建立或者打开一个数据库。</li>
<li>定义相关的SQL命令(Command)通过这些命令实现对数据库的增加、删除、更新、读取四种基本功能。</li>
<li>在完成各种数据库操作后及时关闭数据库连接，解除对数据库的连接和引用。</li>
</ul>
</blockquote>
<p>SQLite作为一款优秀的数据库，在为其编写数据库相关代码时同样遵循这样的流程，考虑到对数据库的增加、删除、更新、读取四种操作具有类似性和统一性，因此在动手写Unity3D脚本前，首先让我们来编写一个SQLite的辅助类SQLiteHelper.cs。该类代码定义如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;&#10;using System.Collections;&#10;using Mono.Data.Sqlite;&#10;using System;&#10;&#10;public class SQLiteHelper&#10;&#123;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#25968;&#25454;&#24211;&#36830;&#25509;&#23450;&#20041;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;private SqliteConnection dbConnection;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// SQL&#21629;&#20196;&#23450;&#20041;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;private SqliteCommand dbCommand;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#25968;&#25454;&#35835;&#21462;&#23450;&#20041;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;private SqliteDataReader dataReader;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#26500;&#36896;&#20989;&#25968;&#9;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;param name=&#34;connectionString&#34;&#62;&#25968;&#25454;&#24211;&#36830;&#25509;&#23383;&#31526;&#20018;&#60;/param&#62;&#10;&#9;public SQLiteHelper(string connectionString)&#10;&#9;&#123;&#10;&#9;&#9;try&#123;&#10;&#9;&#9;&#9;//&#26500;&#36896;&#25968;&#25454;&#24211;&#36830;&#25509;&#10;&#9;&#9;&#9;dbConnection=new SqliteConnection(connectionString);&#10;&#9;&#9;&#9;//&#25171;&#24320;&#25968;&#25454;&#24211;&#10;&#9;&#9;&#9;dbConnection.Open();&#10;&#9;&#9;&#125;catch(Exception e)&#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;Debug.Log(e.Message);&#10;&#9;&#9;&#125;&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#25191;&#34892;SQL&#21629;&#20196;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The query.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;queryString&#34;&#62;SQL&#21629;&#20196;&#23383;&#31526;&#20018;&#60;/param&#62;&#10;&#9;public SqliteDataReader ExecuteQuery(string queryString)&#10;&#9;&#123;&#10;&#9;&#9;dbCommand = dbConnection.CreateCommand();&#10;&#9;&#9;dbCommand.CommandText = queryString;&#10;&#9;&#9;dataReader = dbCommand.ExecuteReader();&#10;&#9;&#9;return dataReader;&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#20851;&#38381;&#25968;&#25454;&#24211;&#36830;&#25509;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;public void CloseConnection()&#10;&#9;&#123;&#10;&#9;&#9;//&#38144;&#27585;Command&#10;&#9;&#9;if(dbCommand != null)&#123;&#10;&#9;&#9;&#9;dbCommand.Cancel();&#10;&#9;&#9;&#125;&#10;&#9;&#9;dbCommand = null;&#10;&#10;&#9;&#9;//&#38144;&#27585;Reader&#10;&#9;&#9;if(dataReader != null)&#123;&#10;&#9;&#9;&#9;dataReader.Close();&#10;&#9;&#9;&#125;&#10;&#9;&#9;dataReader = null;&#10;&#10;&#9;&#9;//&#38144;&#27585;Connection&#10;&#9;&#9;if(dbConnection != null)&#123;&#10;&#9;&#9;&#9;dbConnection.Close();&#10;&#9;&#9;&#125;&#10;&#9;&#9;dbConnection = null;&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#35835;&#21462;&#25972;&#24352;&#25968;&#25454;&#34920;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The full table.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#31216;&#60;/param&#62;&#10;&#9;public SqliteDataReader ReadFullTable(string tableName)&#10;&#9;&#123;&#10;&#9;&#9;string queryString = &#34;SELECT * FROM &#34; + tableName;&#10;&#9;&#9;return ExecuteQuery (queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#21521;&#25351;&#23450;&#25968;&#25454;&#34920;&#20013;&#25554;&#20837;&#25968;&#25454;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The values.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#31216;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;values&#34;&#62;&#25554;&#20837;&#30340;&#25968;&#20540;&#60;/param&#62;&#10;&#9;public SqliteDataReader InsertValues(string tableName,string[] values)&#10;&#9;&#123;&#10;&#9;&#9;//&#33719;&#21462;&#25968;&#25454;&#34920;&#20013;&#23383;&#27573;&#25968;&#30446;&#10;&#9;&#9;int fieldCount=ReadFullTable(tableName).FieldCount;&#10;&#9;&#9;//&#24403;&#25554;&#20837;&#30340;&#25968;&#25454;&#38271;&#24230;&#19981;&#31561;&#20110;&#23383;&#27573;&#25968;&#30446;&#26102;&#24341;&#21457;&#24322;&#24120;&#10;&#9;&#9;if(values.Length!=fieldCount)&#123;&#10;&#9;&#9;&#9;throw new SqliteException(&#34;values.Length!=fieldCount&#34;);&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;string queryString = &#34;INSERT INTO &#34; + tableName + &#34; VALUES (&#34; + values[0];&#10;&#9;&#9;for(int i=1; i&#60;values.Length; i++)&#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34;, &#34; + values[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;queryString += &#34; )&#34;;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#26356;&#26032;&#25351;&#23450;&#25968;&#25454;&#34920;&#20869;&#30340;&#25968;&#25454;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The values.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#31216;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colNames&#34;&#62;&#23383;&#27573;&#21517;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colValues&#34;&#62;&#23383;&#27573;&#21517;&#23545;&#24212;&#30340;&#25968;&#25454;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;key&#34;&#62;&#20851;&#38190;&#23383;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;value&#34;&#62;&#20851;&#38190;&#23383;&#23545;&#24212;&#30340;&#20540;&#60;/param&#62;&#10;&#9;public SqliteDataReader UpdateValues(string tableName,string[] colNames,string[] colValues,string key,string operation,string value)&#10;&#9;&#123;&#10;&#9;&#9;//&#24403;&#23383;&#27573;&#21517;&#31216;&#21644;&#23383;&#27573;&#25968;&#20540;&#19981;&#23545;&#24212;&#26102;&#24341;&#21457;&#24322;&#24120;&#10;&#9;&#9;if(colNames.Length!=colValues.Length) &#123;&#10;&#9;&#9;&#9;throw new SqliteException(&#34;colNames.Length!=colValues.Length&#34;);&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;string queryString = &#34;UPDATE &#34; + tableName + &#34; SET &#34; + colNames[0] + &#34;=&#34; + colValues[0];&#10;&#9;&#9;for(int i=1; i&#60;colValues.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34;, &#34; + colNames[i] + &#34;=&#34; + colValues[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;queryString += &#34; WHERE &#34; + key + operation + value;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#21024;&#38500;&#25351;&#23450;&#25968;&#25454;&#34920;&#20869;&#30340;&#25968;&#25454;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The values.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#31216;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colNames&#34;&#62;&#23383;&#27573;&#21517;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colValues&#34;&#62;&#23383;&#27573;&#21517;&#23545;&#24212;&#30340;&#25968;&#25454;&#60;/param&#62;&#10;&#9;public SqliteDataReader DeleteValuesOR(string tableName,string[] colNames,string[] operations,string[] colValues)&#10;&#9;&#123;&#10;&#9;&#9;//&#24403;&#23383;&#27573;&#21517;&#31216;&#21644;&#23383;&#27573;&#25968;&#20540;&#19981;&#23545;&#24212;&#26102;&#24341;&#21457;&#24322;&#24120;&#10;&#9;&#9;if(colNames.Length!=colValues.Length || operations.Length!=colNames.Length || operations.Length!=colValues.Length) &#123;&#10;&#9;&#9;&#9;throw new SqliteException(&#34;colNames.Length!=colValues.Length || operations.Length!=colNames.Length || operations.Length!=colValues.Length&#34;);&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;string queryString = &#34;DELETE FROM &#34; + tableName + &#34; WHERE &#34; + colNames[0] + operations[0] + colValues[0];&#10;&#9;&#9;for(int i=1; i&#60;colValues.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34;OR &#34; + colNames[i] + operations[0] + colValues[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#21024;&#38500;&#25351;&#23450;&#25968;&#25454;&#34920;&#20869;&#30340;&#25968;&#25454;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The values.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#31216;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colNames&#34;&#62;&#23383;&#27573;&#21517;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colValues&#34;&#62;&#23383;&#27573;&#21517;&#23545;&#24212;&#30340;&#25968;&#25454;&#60;/param&#62;&#10;&#9;public SqliteDataReader DeleteValuesAND(string tableName,string[] colNames,string[] operations,string[] colValues)&#10;&#9;&#123;&#10;&#9;&#9;//&#24403;&#23383;&#27573;&#21517;&#31216;&#21644;&#23383;&#27573;&#25968;&#20540;&#19981;&#23545;&#24212;&#26102;&#24341;&#21457;&#24322;&#24120;&#10;&#9;&#9;if(colNames.Length!=colValues.Length || operations.Length!=colNames.Length || operations.Length!=colValues.Length) &#123;&#10;&#9;&#9;&#9;throw new SqliteException(&#34;colNames.Length!=colValues.Length || operations.Length!=colNames.Length || operations.Length!=colValues.Length&#34;);&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;string queryString = &#34;DELETE FROM &#34; + tableName + &#34; WHERE &#34; + colNames[0] + operations[0] + colValues[0];&#10;&#9;&#9;for(int i=1; i&#60;colValues.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34; AND &#34; + colNames[i] + operations[i] + colValues[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// &#21019;&#24314;&#25968;&#25454;&#34920;&#10;&#9;/// &#60;/summary&#62; +&#10;&#9;/// &#60;returns&#62;The table.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;&#25968;&#25454;&#34920;&#21517;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colNames&#34;&#62;&#23383;&#27573;&#21517;&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colTypes&#34;&#62;&#23383;&#27573;&#21517;&#31867;&#22411;&#60;/param&#62;&#10;&#9;public SqliteDataReader CreateTable(string tableName,string[] colNames,string[] colTypes)&#10;&#9;&#123;&#10;&#9;&#9;string queryString = &#34;CREATE TABLE &#34; + tableName + &#34;( &#34; + colNames [0] + &#34; &#34; + colTypes [0];&#10;&#9;&#9;for (int i=1; i&#60;colNames.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34;, &#34; + colNames[i] + &#34; &#34; + colTypes[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;queryString+= &#34;  ) &#34;;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// Reads the table.&#10;&#9;/// &#60;/summary&#62;&#10;&#9;/// &#60;returns&#62;The table.&#60;/returns&#62;&#10;&#9;/// &#60;param name=&#34;tableName&#34;&#62;Table name.&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;items&#34;&#62;Items.&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colNames&#34;&#62;Col names.&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;operations&#34;&#62;Operations.&#60;/param&#62;&#10;&#9;/// &#60;param name=&#34;colValues&#34;&#62;Col values.&#60;/param&#62;&#10;&#9;public SqliteDataReader ReadTable(string tableName,string[] items,string[] colNames,string[] operations, string[] colValues)&#10;&#9;&#123;&#10;&#9;&#9;string queryString = &#34;SELECT &#34; + items [0];&#10;&#9;&#9;for (int i=1; i&#60;items.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34;, &#34; + items[i];&#10;&#9;&#9;&#125;&#10;&#9;&#9;queryString += &#34; FROM &#34; + tableName + &#34; WHERE &#34; + colNames[0] + &#34; &#34; +  operations[0] + &#34; &#34; + colValues[0];&#10;&#9;&#9;for (int i=0; i&#60;colNames.Length; i++) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;queryString+=&#34; AND &#34; + colNames[i] + &#34; &#34; + operations[i] + &#34; &#34; + colValues[0] + &#34; &#34;;&#10;&#9;&#9;&#125;&#10;&#9;&#9;return ExecuteQuery(queryString);&#10;&#9;&#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>SQLiteHelper类主要实现了数据库、数据表的创建以及数据表中记录的增加、删除、更新、读取四种基本功能。该类最初由国外的Unity3D开发者发布在<a href="http://forum.unity3d.com/threads/28500-SQLite-Class-Easier-Database-Stuff" target="_blank" rel="external">Unity3D官方论坛</a>,后来经<a href="http://www.xuanyusong.com/archives/831" target="_blank" rel="external">宣雨松</a>使用C#进行重写，我在此基础上进行了完善，再此对两位大神的无私付出表示感谢。这里要说明的有三点：</p>
<ul>
<li><p>一、在Unity3D编辑器下生成数据库文件(.db)默认位于和Assets目录同级的位置，即项目的工程文件夹中。我们可以通过修改路径在改变数据库文件的存储位置，具体来讲：<br>Windows平台：data source=Application.dataPath/数据库名称.db<br>IOS平台：data source=Application.persistentDataPath/数据库名称.db<br>Android平台：URL=file:Application.persistentDataPath/数据库名称.db(我想说Android平台就是个奇葩，搞什么特殊化嘛)</p>
</li>
<li><p>二、确保Unity3D编辑器中的.NET版本和MonoDevelop中的.NET版本都为2.0版本，在Unity3D中打包导出的程序可能不会保留数据库文件，因此需要手动将数据库文件拷贝到相应的位置，当然更加合理的方案是将数据库文件存放到StreamingAssets文件夹下，然后在第一次加载游戏的时候将数据库文件复制到对应平台上的存放位置。</p>
</li>
<li><p>三、在使用InsertValues方法时请参考SQLite中字段类型与C#中数据类型的对应关系，博主目前测试了int类型和string类型都没有什么问题，更多类型的数据请大家自行测试然后告诉博主测试的结果，如果大家有兴趣扩展这个辅助类的话可以自行去扩展哦，嘿嘿！</p>
</li>
</ul>
<p>好了，千呼万唤始出来的时候到了，下面我们以一个实例来完成今天的项目讲解，因为我们已经定义好了SQLite的辅助类，因此我们可以快速地编写出下面的脚本代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;&#10;using System.Collections;&#10;using System.IO;&#10;using Mono.Data.Sqlite;&#10;&#10;public class SQLiteDemo : MonoBehaviour &#10;&#123;&#10;&#9;/// &#60;summary&#62;&#10;&#9;/// SQLite&#25968;&#25454;&#24211;&#36741;&#21161;&#31867;&#10;&#9;/// &#60;/summary&#62;&#10;&#9;private SQLiteHelper sql;&#10;&#10;&#9;void Start () &#10;&#9;&#123;&#10;&#9;&#9;//&#21019;&#24314;&#21517;&#20026;sqlite4unity&#30340;&#25968;&#25454;&#24211;&#10;&#9;&#9;sql = new SQLiteHelper(&#34;data source=sqlite4unity.db&#34;);&#10;&#10;&#9;&#9;//&#21019;&#24314;&#21517;&#20026;table1&#30340;&#25968;&#25454;&#34920;&#10;&#9;&#9;sql.CreateTable(&#34;table1&#34;,new string[]&#123;&#34;ID&#34;,&#34;Name&#34;,&#34;Age&#34;,&#34;Email&#34;&#125;,new string[]&#123;&#34;INTEGER&#34;,&#34;TEXT&#34;,&#34;INTEGER&#34;,&#34;TEXT&#34;&#125;);&#10;&#10;&#9;&#9;//&#25554;&#20837;&#20004;&#26465;&#25968;&#25454;&#10;&#9;&#9;sql.InsertValues(&#34;table1&#34;,new string[]&#123;&#34;&#39;1&#39;&#34;,&#34;&#39;&#24352;&#19977;&#39;&#34;,&#34;&#39;22&#39;&#34;,&#34;&#39;Zhang3@163.com&#39;&#34;&#125;);&#10;&#9;&#9;sql.InsertValues(&#34;table1&#34;,new string[]&#123;&#34;&#39;2&#39;&#34;,&#34;&#39;&#26446;&#22235;&#39;&#34;,&#34;&#39;25&#39;&#34;,&#34;&#39;Li4@163.com&#39;&#34;&#125;);&#10;&#10;&#9;&#9;//&#26356;&#26032;&#25968;&#25454;&#65292;&#23558;Name=&#34;&#24352;&#19977;&#34;&#30340;&#35760;&#24405;&#20013;&#30340;Name&#25913;&#20026;&#34;Zhang3&#34;&#10;&#9;&#9;sql.UpdateValues(&#34;table1&#34;, new string[]&#123;&#34;Name&#34;&#125;, new string[]&#123;&#34;&#39;Zhang3&#39;&#34;&#125;, &#34;Name&#34;, &#34;=&#34;, &#34;&#39;&#24352;&#19977;&#39;&#34;);&#10;&#10;&#9;&#9;//&#25554;&#20837;3&#26465;&#25968;&#25454;&#10;&#9;&#9;sql.InsertValues(&#34;table1&#34;,new string[]&#123;&#34;3&#34;,&#34;&#39;&#29579;&#20116;&#39;&#34;,&#34;25&#34;,&#34;&#39;Wang5@163.com&#39;&#34;&#125;);&#10;&#9;&#9;sql.InsertValues(&#34;table1&#34;,new string[]&#123;&#34;4&#34;,&#34;&#39;&#29579;&#20116;&#39;&#34;,&#34;26&#34;,&#34;&#39;Wang5@163.com&#39;&#34;&#125;);&#10;&#9;&#9;sql.InsertValues(&#34;table1&#34;,new string[]&#123;&#34;5&#34;,&#34;&#39;&#29579;&#20116;&#39;&#34;,&#34;27&#34;,&#34;&#39;Wang5@163.com&#39;&#34;&#125;);&#10;&#10;&#9;&#9;//&#21024;&#38500;Name=&#34;&#29579;&#20116;&#34;&#19988;Age=26&#30340;&#35760;&#24405;,DeleteValuesOR&#26041;&#27861;&#31867;&#20284;&#10;&#9;&#9;sql.DeleteValuesAND(&#34;table1&#34;, new string[]&#123;&#34;Name&#34;,&#34;Age&#34;&#125;, new string[]&#123;&#34;=&#34;,&#34;=&#34;&#125;, new string[]&#123;&#34;&#39;&#29579;&#20116;&#39;&#34;,&#34;&#39;26&#39;&#34;&#125;);&#10;&#10;&#9;&#9;//&#35835;&#21462;&#25972;&#24352;&#34920;&#10;&#9;&#9;SqliteDataReader reader = sql.ReadFullTable (&#34;table1&#34;);&#10;&#9;&#9;while(reader.Read()) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;//&#35835;&#21462;ID&#10;&#9;&#9;&#9;Debug.Log(reader.GetInt32(reader.GetOrdinal(&#34;ID&#34;)));&#10;&#9;&#9;&#9;//&#35835;&#21462;Name&#10;&#9;&#9;&#9;Debug.Log(reader.GetString(reader.GetOrdinal(&#34;Name&#34;)));&#10;&#9;&#9;&#9;//&#35835;&#21462;Age&#10;&#9;&#9;&#9;Debug.Log(reader.GetInt32(reader.GetOrdinal(&#34;Age&#34;)));&#10;&#9;&#9;&#9;//&#35835;&#21462;Email&#10;&#9;&#9;&#9;Debug.Log(reader.GetString(reader.GetOrdinal(&#34;Email&#34;)));&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;//&#35835;&#21462;&#25968;&#25454;&#34920;&#20013;Age&#62;=25&#30340;&#25152;&#26377;&#35760;&#24405;&#30340;ID&#21644;Name&#10;&#9;&#9;reader = sql.ReadTable (&#34;table1&#34;, new string[]&#123;&#34;ID&#34;,&#34;Name&#34;&#125;, new string[]&#123;&#34;Age&#34;&#125;, new string[]&#123;&#34;&#62;=&#34;&#125;, new string[]&#123;&#34;&#39;25&#39;&#34;&#125;);&#10;&#9;&#9;while(reader.Read()) &#10;&#9;&#9;&#123;&#10;&#9;&#9;&#9;//&#35835;&#21462;ID&#10;&#9;&#9;&#9;Debug.Log(reader.GetInt32(reader.GetOrdinal(&#34;ID&#34;)));&#10;&#9;&#9;&#9;//&#35835;&#21462;Name&#10;&#9;&#9;&#9;Debug.Log(reader.GetString(reader.GetOrdinal(&#34;Name&#34;)));&#10;&#9;&#9;&#125;&#10;&#10;&#9;&#9;//&#33258;&#23450;&#20041;SQL,&#21024;&#38500;&#25968;&#25454;&#34920;&#20013;&#25152;&#26377;Name=&#34;&#29579;&#20116;&#34;&#30340;&#35760;&#24405;&#10;&#9;&#9;sql.ExecuteQuery(&#34;DELETE FROM table1 WHERE NAME=&#39;&#29579;&#20116;&#39;&#34;);&#10;&#10;&#9;&#9;//&#20851;&#38381;&#25968;&#25454;&#24211;&#36830;&#25509;&#10;&#9;&#9;sql.CloseConnection();&#10;&#9;&#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>在上面的代码中我们是在Start方法中创建了数据库和数据表，然而在实际使用中我们需要判断数据库和数据表是否存在，因此如果你使用这段脚本提示错误信息，请确保数据库和数据表是否已经存在。好了，下面的截图展示了程序运行的结果：</p>
<p><img src="http://img.blog.csdn.net/20150709094136317" alt="数据库效果演示"></p>
<p><img src="http://img.blog.csdn.net/20150709094212852" alt="Unity3D效果展示"></p>
<p>作为一个强大的数据库怎么能没有图形化的数据库管理工具呢？所以这里博主向大家推荐一个免安装的小工具SqliteStudio，使用这个工具可以帮助我们方便地管理Sqlite数据库里的数据，这样是不是比较方便呢？哈哈！这个工具可以从<a href="http://pan.baidu.com/s/1hqldZ3A" target="_blank" rel="external">这里</a>下载哦！</p>
<p><img src="http://img.blog.csdn.net/20150709094346962" alt="SQLiteStudio界面演示"></p>
<p>好了，今天的内容就是这样了，为了写这篇文章花了三个晚上准备，希望大家喜欢啊！如果大家觉得这篇文章有用，请继续关注我的博客，我是秦元培，我的博客地址是<a href="http://blog.csdn.net/qinyuanpei" target="_blank" rel="external">http://blog.csdn.net/qinyuanpei</a>。</p>

  </section>

</article>


<section class="post-comments">
  <!-- 多说评论框 start -->
  <div class="ds-thread" data-thread-key="http://qinyuanpei.com/2015/07/09/sqlite-in-unity3d/" data-title="Unity3D游戏开发之SQLite让数据库开发更简单" data-url="http://qinyuanpei.com/2015/07/09/sqlite-in-unity3d/"></div>
  <!-- 多说评论框 end -->
  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <script type="text/javascript">
  var duoshuoQuery = {short_name:"qinyuanpei"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end -->
</section>



            <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<footer class="footer">
    <span class="footer__copyright">
        本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
    </span>
    <span class="footer__copyright">
        基于 <a href="http://hexo.io">Hexo</a> 搭建，感谢 <a href="https://pages.github.com/">GitHub Pages</a> 提供免费的托管服务
    </span>
    <span class="footer__copyright">
        &copy; 2015 - 本站由 <a href="/">秦元培</a> 创建,
        基于<https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">hexo-theme-vno</a>主题修改,
    总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
</footer>

        </div>
    </div>

    <script src="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
    <script src="/js/main.js" type="text/javascript"></script>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-42596364-1', 'auto');
	ga('send', 'pageview');
</script>

</body>
</html>
